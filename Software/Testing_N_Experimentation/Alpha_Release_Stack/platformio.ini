; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

; ============================================================
; COM Port Assignments:
;   CPU = COM15
;   GPU = COM16
; ============================================================

[platformio]
default_envs = CPU, GPU
description = ARCOS LED Control System - Synth-Head Firmware

[env:CPU]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DARDUINO_USB_MSC_ON_BOOT=0
	-DARDUINO_USB_DFU_ON_BOOT=0
	-DTARGET_CPU
	-std=c++17
build_src_filter = -<*> +<CPU.cpp>

[env:GPU]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM16
monitor_port = COM16
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DTARGET_GPU
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU.cpp>

; ============================================================
; HAL Test Environments
; ============================================================

[env:CPU_HAL_Test]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
lib_deps = 
	adafruit/Adafruit NeoPixel @ ^1.12.2
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DARDUINO_USB_MSC_ON_BOOT=0
	-DARDUINO_USB_DFU_ON_BOOT=0
	-DTARGET_CPU
	-DHAL_TEST_MODE
	-std=c++17
build_src_filter = -<*> +<CPU_HAL_Test.cpp>

[env:GPU_HAL_Test]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM3
monitor_port = COM3
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DHAL_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DTARGET_GPU
	-DHAL_TEST_MODE
	-std=c++17
	-I ../include

; ============================================================
; Base System API Test Environments
; ============================================================

[env:CPU_BaseAPI_Test]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
lib_deps = 
	adafruit/Adafruit NeoPixel @ ^1.12.2
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DARDUINO_USB_MSC_ON_BOOT=0
	-DARDUINO_USB_DFU_ON_BOOT=0
	-DTARGET_CPU
	-DBASE_API_TEST_MODE
	-std=c++17
build_src_filter = -<*> +<CPU_BaseAPI_Test.cpp>

[env:GPU_BaseAPI_Test]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM3
monitor_port = COM3
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DBASE_API_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DTARGET_GPU
	-DBASE_API_TEST_MODE
	-std=c++17
	-I ../include
; ============================================================
; Simple UART Test Environments
; ============================================================

[env:CPU_Simple_UART]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DCPU_BUILD
	-std=c++17
build_src_filter = -<*> +<SimpleUARTTest.cpp>

[env:GPU_Simple_UART]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM3
monitor_port = COM3
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DSIMPLE_UART_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-std=c++17

; ============================================================
; GPU DRIVER DEMO ENVIRONMENTS
; ============================================================

[env:CPU_GpuDriver]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DCPU_BUILD
	-DGPU_DRIVER_DEMO
	-std=c++17
build_src_filter = -<*> +<CPU_GpuDriver_Example.cpp>

[env:GPU_GpuDriver]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_DRIVER_DEMO
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_GpuDriver_Example.cpp>

; ============================================================
; GPU DRIVER HARDWARE INTEGRATION TESTS
; ============================================================

[env:CPU_GpuDriver_Test]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DCPU_BUILD
	-DGPU_DRIVER_TEST
	-std=c++17
build_src_filter = -<*> +<CPU_GpuDriver_Test.cpp>

[env:GPU_GpuDriver_Test]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_DRIVER_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_DRIVER_TEST
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_GpuDriver_Test.cpp>

; ============================================================
; BAUD RATE TEST ENVIRONMENTS (1-20 Mbps)
; ============================================================

[env:CPU_BaudTest]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DCPU_BUILD
	-DBAUD_TEST_MODE
	-std=c++17
build_src_filter = -<*> +<CPU_BaudTest.cpp>

[env:GPU_BaudTest]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DBAUD_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DBAUD_TEST_MODE
	-std=c++17

; ============================================================
; GPU ADVANCED DEMO (SDF Morphing + Antialiasing + Shader)
; ============================================================

[env:GPU_Advanced_Demo]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_ADVANCED_DEMO_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_ADVANCED_DEMO
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_Advanced_Demo.cpp>

; ============================================================
; GPU OPTIMIZED DEMO (60+ FPS with research-backed algorithms)
; Scanline fill, Fixed-point, Wu's AA, LUTs
; ============================================================

[env:GPU_Optimized_Demo]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_OPTIMIZED_DEMO_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_OPTIMIZED_DEMO
	-O3
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_Advanced_Demo_Optimized.cpp>

; ============================================================
; GPU COMMAND RENDERER (Dual Panel + OLED with CPU Commands)
; Renders 2 polygon shapes, one per panel, with OLED support
; ============================================================

[env:GPU_Command_Renderer]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_COMMAND_RENDERER_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_COMMAND_RENDERER
	-O3
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_CommandRenderer.cpp>

; ============================================================
; GPU DISPLAY SLAVE (Pure Receiver - No Local Rendering)
; Receives frames from CPU and displays them
; Optimizations: DMA, double-buffer, dirty-flag updates
; ============================================================

[env:GPU_Display_Slave]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_DISPLAY_SLAVE_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_DISPLAY_SLAVE
	-O3
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_DisplaySlave.cpp>

; ============================================================
; GPU PROGRAMMABLE (Shader VM - No Hardcoded Effects)
; CPU uploads shaders, sprites, variables
; GPU executes bytecode and renders
; ============================================================

[env:GPU_Programmable]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM5
monitor_port = COM5
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.sdkconfig_defaults = sdkconfig.defaults.GPU
board_build.cmake_extra_args = -DGPU_PROGRAMMABLE_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DGPU_BUILD
	-DGPU_PROGRAMMABLE
	-O3
	-std=c++17
	-I ../include
build_src_filter = -<*> +<GPU_Programmable.cpp>

[env:CPU_Programmable_Test]
platform = espressif32
board = esp32s3usbotg
framework = espidf
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
board_build.flash_size = 8MB
board_build.cmake_extra_args = -DCPU_PROGRAMMABLE_TEST_MODE=1
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT
	-DCPU_BUILD
	-DCPU_PROGRAMMABLE_TEST
	-O3
	-std=c++17
build_src_filter = -<*> +<CPU_Programmable_Test.cpp>

; ============================================================
; GPU COMPREHENSIVE COMMAND TEST
; ============================================================

[env:CPU_Full_Command_Test]
platform = espressif32 @ 6.12.0
board = esp32s3usbotg
framework = arduino
upload_port = COM15
monitor_port = COM15
monitor_speed = 115200
build_flags = 
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DARDUINO_USB_MODE=2
	-DCPU_BUILD
	-DFULL_COMMAND_TEST
	-std=c++17
build_src_filter = -<*> +<CPU_Full_Command_Test.cpp>
